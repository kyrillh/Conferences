\section{Introduction to nonlinear Schwarz methods}

\begin{frame}{Motivation: linear vs nonlinear preconditioning}
	Discretized nonlinear partial differential equation: $F(u) = 0$
	\begin{columns}
		\begin{column}{0.5\textwidth}
			\vspace*{-4mm}
			\begin{block}{\normalsize Linear preconditioner}
				\begin{enumerate}
					\item Linearize:
					      \begin{equation*}
						      DF(u^k)\delta^{k+1} = F(u^k)
					      \end{equation*}
					\item Improve linear solver performance with Schwarz preconditioner:
					      \begin{equation*}
						      \mathcal{M}_{OS}^{-1}DF(u^k)\delta^{k+1} = \mathcal{M}_{OS}^{-1}F(u^k)
					      \end{equation*}
				\end{enumerate}
				\vspace*{4mm}
				Goal:
				\begin{itemize}
					\item $\kappa(\mathcal{M}_{OS}^{-1}DF(u^k)) \approx 1$
				\end{itemize}
			\end{block}
		\end{column}
		\begin{column}{0.5\textwidth}
			\vspace*{-4mm}
			\begin{block}{\normalsize Nonlinear preconditioner}
				\begin{enumerate}
					\item Reformulate the original nonlinear problem based on local nonlinear corrections
					      \begin{equation}
						      \mathcal{F}(u) = G(F(u)) = 0
					      \end{equation}
					\item Linearize $\mathcal{F}(u) = 0$ and solve iterativily
				\end{enumerate}
				Goal:
				\begin{itemize}
					\item $\mathcal{F}(u)$ more linear than $F(u)$
					\item $\mathcal{F}(u^*) = 0 \iff F(u^*) = 0$
				\end{itemize}
			\end{block}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}{Nonlinear Schwarz}%: Nonlinearly preconditioned inexact Newton algorithms}}
    \input{images/tikz/nonlinear-schwarz-schematic.tex}
\end{frame}

\begin{frame}{One-level nonlinear Schwarz \footnote{\tiny Cai and Keyes 2002}}%: Nonlinearly preconditioned inexact Newton algorithms}}
	% \only<1-3>{
		Discretized nonlinear partial differential equation: F (u) = 0
	    \vspace*{-5mm}
	% }
	% \only<4->{
	%     \vspace*{-10mm}
	% }

	\begin{columns}
		\begin{column}{0.5\textwidth}
			\begin{block}<1->{\normalsize Nonlinear corrections $T_i(u): V\mapsto V_i$}
				\vspace*{-5mm}
				\begin{align*}
					 & R_iF(u-P_iT_i(u))  = 0, \quad i = 1,2,\dots N                \\
					 & \text{with}\quad R_i:V\mapsto V_i\text{,}\, P_i:V_i\mapsto V
				\end{align*}
			\end{block}
		\end{column}
		\begin{column}{0.5\textwidth}
			\begin{block}<2->{\normalsize Define an alternative nonlinear problem}
				\begin{equation*}
					\mathcal{F}_1(u) \coloneqq \sum_{i=1}^N\alert<4>{P_iT_i(u)} = 0
				\end{equation*}
			\end{block}
		\end{column}
	\end{columns}
	\begin{block}<3->{\normalsize Nonlinear Schwarz method results by solving $\mathcal{F}_1(u) = 0$ with Newton's method.\newline Setting $u_i = u-P_iT_i(u)$ the Jacobian can be formulated as:}
		\vspace*{-2mm}
		\begin{align*}
			D\mathcal{F}_1(u^k)  = \sum_{i = 1}^NP_iDT_i(u^k) = \sum_{i=1}^N\alert<4>{P_i(R_iDF(u_i^k)P_i)^{-1}R_iDF(u_i^k)}
		\end{align*}
	\end{block}
	\only<4>{%
		\tikz[overlay,remember picture]
		\node[fill=white,text=red] at ([xshift=0cm,yshift=-3cm]current page.center){\Large Parallel execution!};
	}
	% \only<4>{%
	% \begin{itemize}
	% 	\item For the one-level nonlinear Schwarz method the solutions of $F(u) = 0$ and $\mathcal{F}_1(u) = 0$ are equivalent
	% 	\item The global operators $DF(u_i)$ only need to be assembled locally
	% \end{itemize}
	% }
\end{frame}

\begin{frame}{Adding a second level}
	Build coarse space basis functions $\rightarrow$ $R_0$ and $P_0$ 
    \begin{block}{RGDSW coarse space \footnotemark{}}
		Define coarse basis $\Phi : V_0\mapsto V$
		\begin{enumerate}
			\setlength{\itemsep}{10pt}
			\item Build $\Phi_\Gamma$ as a partition of unity on the interface $\Gamma$
			\item $\Phi_I = -A_{II}^{-1}A_{I\Gamma}\Phi_\Gamma$ an energy minimizing extension into the interior
		\end{enumerate}
	\end{block}
	\only<2>{ % Compile twice for proper placement
		For example:
		\begin{columns}
			\begin{column}{0.39\textwidth}
				\vspace*{-6mm}
				\begin{figure}
					\includegraphics[width=0.45\textwidth]{images/decomposed_domain.jpg}
				\end{figure}
			\end{column}
            \hspace*{-20mm}
			\begin{column}{0.4\textwidth}
				\vspace*{-9mm}
				\begin{figure}
					\includegraphics[width=0.65\textwidth]{images/r22.png}
				\end{figure}
			\end{column}
		\end{columns}
	}
	\only<3>{
		Summary:
		\begin{equation*}
			\Phi =
			\begin{pmatrix}
				\Phi_I \\  \Phi_\Gamma
			\end{pmatrix} =
			\begin{pmatrix}
				-A_{II}^{-1}A_{I\Gamma}\Phi_\Gamma \\ \Phi_\Gamma
			\end{pmatrix}
		\end{equation*}
		and
		\begin{equation*}
			P_0 \coloneqq \Phi\text{,}\quad R_0 \coloneqq \Phi^T
		\end{equation*}
	}
\footnotetext{\tiny Dohrmann, Widlund (2017)}
\end{frame}

\begin{frame}{Two-level additive nonlinear Schwarz \footnote{\tiny Heinlein, Lanser (2020)} \footnote{\tiny Heinlein, Lanser, Klawonn (2022)}}
	% \vspace*{-5mm}
	\begin{columns}
		\begin{column}{0.5\textwidth}
			\begin{block}{\normalsize Nonlinear corrections $T_i(u)$}
				\vspace*{-1mm}
				\begin{align*}
					 & R_iF(u-P_iT_i(u))  = 0, \quad i = \alert{0},1,2,\dots N      \\
					 & \text{with}\quad R_i:V\mapsto V_i\text{,}\, P_i:V_i\mapsto V
				\end{align*}
			\end{block}
		\end{column}
		\begin{column}{0.5\textwidth}
			\begin{block}{\normalsize Alternative nonlinear problem}
				\begin{equation*}
					\mathcal{F}_A(u) \coloneqq \alert{P_0T_0(u)} + \sum_{i=1}^NP_iT_i(u) = 0
				\end{equation*}
			\end{block}
		\end{column}
	\end{columns}
	\begin{block}{\normalsize The Jacobian}
		\vspace*{-2mm}
		\begin{align*}
			D\mathcal{F}_A(u^k)  = \alert{P_0(R_0DF(u_0^k)P_0)^{-1}R_0DF(u_0^k)} + \sum_{i=1}^NP_i(R_iDF(u_i^k)P_i)^{-1}R_iDF(u_i^k)
		\end{align*}
	\end{block}
\end{frame}

\begin{frame}{Two-level hybrid nonlinear Schwarz  \footnote[3]{\tiny Heinlein, Lanser (2020)} \footnote[4]{\tiny Heinlein, Lanser, Klawonn (2022)}}
	\vspace*{-5mm}
	\begin{block}{\normalsize Alternative nonlinear problem}
		\begin{equation*}
			\mathcal{F}_{hybrid}(u) \coloneqq \sum_{i=1}^NP_iT_i(u-P_0T_0(u)) + P_0T_0(u),
		\end{equation*}
	\end{block}
	\begin{block}{\normalsize The Jacobian}
		\vspace*{-2mm}
		\begin{equation*}
			D\mathcal{F}_{hybrid}(u^k) = I - \left(I-\sum_{i=1}^NQ_i(v_i)\right)(I-Q_0(u_0))
		\end{equation*}
		\begin{align*}
			\text{with}\quad Q_i(u) & \coloneqq P_i(R_iDF(u)P_i)^{-1}R_iDF(u), \\
			u_i                     & \coloneqq u-P_iT_i(u)                    \\
			\text{and}\quad v_i     & \coloneqq u_0-P_iT_i(u_0)
		\end{align*}
	\end{block}
\end{frame}
